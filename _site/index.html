<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile Citizenship Toolkit - Kunsthall Stavanger</title>
    <link rel="stylesheet" href="assets/style.css">
</head>

<body>
    <div class="s-image" id="s-image"></div>
    <div class="quote" id="quote"></div>
    <button id="rotate-btn">â†»</button>
    <main id="library">
        <div class="storage" id="deg_0">
            <div class="entry" id="en-1-1">Hey, Hey, Look at Me!: Lex Brown on Clowns, Citizenship, and the Power of
                Play</div>
            <div class="entry" id="en-1-2"
                data-hover-text="This publication is made possible with support from Arts and Culture Norway"><a
                    href="contributor.html">Contributors</a></div>
            <div class="entry" id="en-1-3">Foreword, Lee Heinemann</div>
            <div class="brick" id="brk-1-1">

            </div>
            <div class="brick" id="brk-1-2"></div>
            <div class="brick" id="brk-1-3"></div>
        </div>
        <div class="storage" id="deg_90">
            <div class="entry" id="en-2-1"><a href="youth-workers">How Youth Workers Create Meaningful Encounters for
                    Young People</a></div>
            <div class="entry" id="en-2-2"><a href="self-as-archive">Self as Archive: Erasure + World-Building</a></div>
            <div class="entry" id="en-2-3"></div>
            <div class="entry" id="en-2-4"></div>
            <div class="brick" id="brk-2-1"></div>
        </div>
        <div class="storage" id="deg_180">
            <div class="entry" id="en-3-1">Foreword, Kristina Ketola Bore</div>
            <div class="entry" id="en-3-2"><a href="are-you-listening">Are You Listening? Deep Listening as Youth
                    Pedagogy</a></div>
            <div class="entry" id="en-3-3"><a href="let-me-be-for-you">Let Me Be for You What I Needed When I Was Your
                    Age</a></div>
            <div class="brick" id="brk-3-1"></div>
            <div class="brick" id="brk-3-2"></div>
        </div>
        <div class="storage" id="deg_270">
            <div class="entry" id="en-4-1"
                data-hover-text="Designed by nicole killian, rasim bayramov and khai chuang<br><br>Typefaces: Velvelyne & Compagnon by Velvetyne Type Foundry">
                Credits</div>
            <div class="entry" id="en-4-2">What We Hold Sacred Altar-Making Workshop</div>
            <div class="entry" id="en-4-3"></div>
            <div class="entry" id="en-4-4"><a href="a-space-for-agency">A Space for Agency: Walk of Shame on Cultivating
                    Collective Care in Education</a>
            </div>
            <div class="brick" id="brk-4-1">
            </div>
        </div>
        </div>

    </main>
    <aside>
        <div id="home">
            <h3>Mobile</h3>
            <h3>Citizenship</h3>
            <h3>Toolkit</h3>
        </div>
        <div class="top">
            <div class="summary">A collection of resources exploring youth engagement and participatory practices. This
                toolkit provides methodologies for creating inclusive spaces where young voices can shape their
                communities.A collection of resources exploring youth engagement and participatory practices. This
                toolkit provides methodologies for creating inclusive spaces where young voices can shape their
                communities.</div>
        </div>
        <div id="about">
            <div id="cred-line">This toolkit is produced by<img src="assets/ks-logo.svg"></div>
        </div>
        <div class="bottom">
            <div class="album-preview"><video autoplay muted loop>
                    <source src="img/KS_MC24.mp4" type="video/mp4" />
                </video></div>
            <div class="gallery">
                <img class="g-image">
                <img class="g-image">
            </div>
        </div>
        </div>
        </div>
    </aside>
    <audio src="assets/knock.wav" class="sound" id="knock-sound"></audio>
    <audio src="https://raw.githubusercontent.com/cartalan/Xilofono-Exercise/master/sound/1-DO.mp3" class="sound"
        id="sound1"></audio>
    <audio src="https://raw.githubusercontent.com/cartalan/Xilofono-Exercise/master/sound/2-RE.mp3" class="sound"
        id="sound2"></audio>
    <audio src="https://raw.githubusercontent.com/cartalan/Xilofono-Exercise/master/sound/3-MI.mp3" class="sound"
        id="sound3"></audio>
    <audio src="https://raw.githubusercontent.com/cartalan/Xilofono-Exercise/master/sound/4-FA.mp3" class="sound"
        id="sound4"></audio>
    <audio src="https://raw.githubusercontent.com/cartalan/Xilofono-Exercise/master/sound/5-SOL.mp3" class="sound"
        id="sound5"></audio>
    <audio src="https://raw.githubusercontent.com/cartalan/Xilofono-Exercise/master/sound/6-LA.mp3" class="sound"
        id="sound6"></audio>
    <audio src="https://raw.githubusercontent.com/cartalan/Xilofono-Exercise/master/sound/7-SI.mp3" class="sound"
        id="sound7"></audio>
    <audio src="https://raw.githubusercontent.com/cartalan/Xilofono-Exercise/master/sound/8-DO.mp3" class="sound"
        id="sound8"></audio>

    <script>
        const quotes = [
            "The future belongs to young people with an education and the imagination to create.",
            "Youth is the engine of change, the catalyst for innovation in our communities.",
            "When we listen to young voices, we hear the future speaking to the present.",
            "Citizenship is not a status but a practice of engagement and responsibility.",
            "Every young person carries within them the potential to reshape our world.",
            "The most powerful tool for change is a mind empowered with knowledge and creativity.",
            "In the intersection of art and citizenship, we find new ways of being together.",
            "Youth participation isn't about giving voice, but about creating spaces where voices can be heard."
        ];

        const imageUrls = [
            "img/self-as-archive/MobilizingCitizenship_Art_008WEB.webp",
            "img/self-as-archive/MobilizingCitizenship_Art_010WEB.webp",
            "img/self-as-archive/MobilizingCitizenship_Art_019WEB.webp",
            "img/self-as-archive/MobilizingCitizenship_Art_018WEB.webp",
            "img/self-as-archive/My Work-Ekphrastic Poetry Slide.webp",
            "img/self-as-archive/My Work-Self as Archive Slide.webp",
            "img/self-as-archive/Reality TV Screenshot Dupe 1.webp",
            "img/self-as-archive/Reality TV Screenshot Dupe 3.webp",
            "img/self-as-archive/Reality TV Screenshot Dupe 3.webp",
            "img/self-as-archive/Reality TV Screenshot Dupe 4.webp",
            "img/self-as-archive/Reality TV Screenshot Dupe 5.webp",
        ];


        function positionRandomElements() {
            const image = document.getElementById('s-image');
            const randomImageIndex = Math.floor(Math.random() * imageUrls.length);
            image.style.backgroundImage = `url(${imageUrls[randomImageIndex]})`;

            const quote = document.getElementById('quote');
            const randomQuoteIndex = Math.floor(Math.random() * quotes.length);
            quote.textContent = quotes[randomQuoteIndex];

            quote.dataset.originalQuote = quotes[randomQuoteIndex];
        }

        function populateGalleryImages() {
            const galleryImages = document.querySelectorAll('.g-image');

            const shuffledImages = [...imageUrls].sort(() => Math.random() - 0.5);

            galleryImages.forEach((imgElement, index) => {
                if (shuffledImages[index]) {
                    imgElement.src = shuffledImages[index];
                    imgElement.alt = 'Waiting for image...';
                }
            });
        }

        document.addEventListener('DOMContentLoaded', function () {
            positionRandomElements();
            populateGalleryImages();
            setupEmptyEntryInteractions();

            const rotateBtn = document.getElementById('rotate-btn');
            const library = document.getElementById('library');
            let currentRotation = 0;

            rotateBtn.addEventListener('click', () => {
                currentRotation += 90;
                library.style.transform = `rotate(${currentRotation}deg)`;
                rotateBtn.style.transform = `translate(-50%, -50%) rotate(${-currentRotation}deg)`;
            });

            const entries = document.querySelectorAll('.entry, .brick[data-hover-text]'); const quoteElement = document.getElementById('quote');

            entries.forEach(element => {
                element.addEventListener('mouseenter', () => {
                    // Save the original quote text only once
                    if (!quoteElement.dataset.originalQuote) {
                        quoteElement.dataset.originalQuote = quoteElement.innerHTML;
                    }

                    // Prefer the data-hover-text if it exists
                    const hoverText = element.getAttribute('data-hover-text');
                    if (hoverText) {
                        quoteElement.innerHTML = hoverText; // allows <br> and HTML tags
                    } else {
                        // fallback: show link text or entry text
                        const link = element.querySelector('a');
                        quoteElement.textContent = link ? link.textContent : element.textContent;
                    }
                });

                element.addEventListener('mouseleave', () => {
                    // Restore original quote
                    quoteElement.innerHTML = quoteElement.dataset.originalQuote;
                });
            });


            function setupXylophoneEffect() {
                const homeWords = document.querySelectorAll('#home h3');

                const sounds = [
                    document.getElementById('sound1'),
                    document.getElementById('sound2'),
                    document.getElementById('sound3'),
                    document.getElementById('sound4'),
                    document.getElementById('sound5'),
                    document.getElementById('sound6'),
                    document.getElementById('sound7'),
                    document.getElementById('sound8')
                ];

                let soundCounter = 0;

                homeWords.forEach(wordElement => {
                    const text = wordElement.textContent;
                    wordElement.textContent = '';

                    for (let i = 0; i < text.length; i++) {
                        const letter = document.createElement('span');
                        letter.className = 'letter';
                        letter.textContent = text[i];

                        const soundIndex = soundCounter % sounds.length;
                        letter.addEventListener('mouseenter', () => {
                            sounds[soundIndex].currentTime = 0;
                            sounds[soundIndex].play();
                        });

                        wordElement.appendChild(letter);
                        soundCounter++;
                    }
                });
            }

            const topDrawer = document.querySelector('#home');
            const bottomDrawer = document.querySelector('#about');

            const originalTopPosition = 0;
            const originalBottomPosition = 0;

            let isDraggingTop = false;
            let startYTop, startTranslateTop, currentTranslateTop = 0;

            let isDraggingBottom = false;
            let startYBottom, startTranslateBottom, currentTranslateBottom = 0;

            topDrawer.addEventListener('mousedown', (e) => {
                isDraggingTop = true;
                startYTop = e.clientY;
                startTranslateTop = currentTranslateTop;
                topDrawer.style.transition = 'none';
                e.preventDefault();
            });

            bottomDrawer.addEventListener('mousedown', (e) => {
                isDraggingBottom = true;
                startYBottom = e.clientY;
                startTranslateBottom = currentTranslateBottom;
                bottomDrawer.style.transition = 'none';
                e.preventDefault();
            });

            function setupMobileToggles() {
                const homeElement = document.getElementById('home');
                const topElement = document.querySelector('.top');
                const contributorBrick = document.getElementById('brk-1-1');
                const creditsBrick = document.getElementById('brk-4-1');

                homeElement.addEventListener('click', function (e) {
                    if (window.innerWidth <= 768) {
                        e.stopPropagation();
                        topElement.classList.toggle('active');
                        if (contributorBrick) contributorBrick.classList.remove('active');
                        if (creditsBrick) creditsBrick.classList.remove('active');
                    }
                });

                if (contributorBrick) {
                    contributorBrick.addEventListener('click', function (e) {
                        if (window.innerWidth <= 768) {
                            e.stopPropagation();
                            const isActive = this.classList.contains('active');
                            this.classList.toggle('active');

                            if (this.classList.contains('active')) {
                                this.innerHTML = this.dataset.hoverText;
                            } else {
                                this.innerHTML = 'Contributors';
                            }

                            topElement.classList.remove('active');
                            if (creditsBrick) {
                                creditsBrick.classList.remove('active');
                                creditsBrick.innerHTML = 'Credits';
                            }
                        }
                    });
                }

                if (creditsBrick) {
                    creditsBrick.addEventListener('click', function (e) {
                        if (window.innerWidth <= 768) {
                            e.stopPropagation();
                            const isActive = this.classList.contains('active');
                            this.classList.toggle('active');

                            if (this.classList.contains('active')) {
                                this.innerHTML = this.dataset.hoverText;
                            } else {
                                this.innerHTML = 'Credits';
                            }

                            topElement.classList.remove('active');
                            if (contributorBrick) {
                                contributorBrick.classList.remove('active');
                                contributorBrick.innerHTML = 'Contributors';
                            }
                        }
                    });
                }

                document.addEventListener('click', function (e) {
                    if (window.innerWidth <= 768) {
                        if (!homeElement.contains(e.target) && !topElement.contains(e.target)) {
                            topElement.classList.remove('active');
                        }

                        if (contributorBrick && !contributorBrick.contains(e.target) && contributorBrick.classList.contains('active')) {
                            contributorBrick.classList.remove('active');
                            contributorBrick.innerHTML = 'Contributors';
                        }

                        if (creditsBrick && !creditsBrick.contains(e.target) && creditsBrick.classList.contains('active')) {
                            creditsBrick.classList.remove('active');
                            creditsBrick.innerHTML = 'Credits';
                        }
                    }
                });
            }

            setupMobileToggles();

            document.addEventListener('mousemove', (e) => {
                if (isDraggingTop) {
                    const deltaY = e.clientY - startYTop;
                    currentTranslateTop = Math.min(Math.max(startTranslateTop + deltaY, -topDrawer.offsetHeight + 120), topDrawer.offsetHeight * 0.4);

                    topDrawer.style.transform = `translateY(${currentTranslateTop}px)`;
                }

                if (isDraggingBottom) {
                    const deltaY = e.clientY - startYBottom;
                    currentTranslateBottom = Math.min(Math.max(startTranslateBottom + deltaY, -bottomDrawer.offsetHeight * 0.4), bottomDrawer.offsetHeight - 40);

                    bottomDrawer.style.transform = `translateY(${currentTranslateBottom}px)`;
                }
            });

            document.addEventListener('mouseup', () => {
                if (isDraggingTop) {
                    isDraggingTop = false;
                    topDrawer.style.transition = 'transform 0.5s eascubic-bezier(0.5, 1, 0.89, 1)e';

                    if (currentTranslateTop < -topDrawer.offsetHeight * 0.7) {
                        currentTranslateTop = -topDrawer.offsetHeight + 40;
                    } else if (currentTranslateTop < -topDrawer.offsetHeight * 0.3) {
                        currentTranslateTop = -topDrawer.offsetHeight * 0.5;
                    } else {
                        currentTranslateTop = 0;
                    }

                    topDrawer.style.transform = `translateY(${currentTranslateTop}px)`;
                }

                if (isDraggingBottom) {
                    isDraggingBottom = false;
                    bottomDrawer.style.transition = 'transform 0.5s cubic-bezier(0.5, 1, 0.89, 1)';

                    if (currentTranslateBottom > bottomDrawer.offsetHeight * 0.7) {
                        currentTranslateBottom = bottomDrawer.offsetHeight - 76;
                    } else if (currentTranslateBottom > bottomDrawer.offsetHeight * 0.3) {
                        currentTranslateBottom = bottomDrawer.offsetHeight * 0.5;
                    } else {
                        currentTranslateBottom = 0;
                    }

                    bottomDrawer.style.transform = `translateY(${currentTranslateBottom}px)`;
                }
            });

            topDrawer.addEventListener('touchstart', (e) => {
                isDraggingTop = true;
                startYTop = e.touches[0].clientY;
                startTranslateTop = currentTranslateTop;
                topDrawer.style.transition = 'none';
                e.preventDefault();
            });

            bottomDrawer.addEventListener('touchstart', (e) => {
                isDraggingBottom = true;
                startYBottom = e.touches[0].clientY;
                startTranslateBottom = currentTranslateBottom;
                bottomDrawer.style.transition = 'none';
                e.preventDefault();
            });

            document.addEventListener('touchmove', (e) => {
                if (isDraggingTop) {
                    const deltaY = e.touches[0].clientY - startYTop;
                    currentTranslateTop = Math.min(Math.max(startTranslateTop + deltaY, -topDrawer.offsetHeight + 40), topDrawer.offsetHeight * 0.4);
                    topDrawer.style.transform = `translateY(${currentTranslateTop}px)`;
                }

                if (isDraggingBottom) {
                    const deltaY = e.touches[0].clientY - startYBottom;
                    currentTranslateBottom = Math.min(Math.max(startTranslateBottom + deltaY, -bottomDrawer.offsetHeight * 0.4), bottomDrawer.offsetHeight - 40);
                    bottomDrawer.style.transform = `translateY(${currentTranslateBottom}px)`;
                }
            });

            document.addEventListener('touchend', () => {
                if (isDraggingTop) {
                    isDraggingTop = false;
                    topDrawer.style.transition = 'transform 0.3s ease';

                    if (currentTranslateTop < -topDrawer.offsetHeight * 0.7) {
                        currentTranslateTop = -topDrawer.offsetHeight + 40;
                    } else if (currentTranslateTop < -topDrawer.offsetHeight * 0.3) {
                        currentTranslateTop = -topDrawer.offsetHeight * 0.5;
                    } else {
                        currentTranslateTop = 0;
                    }

                    topDrawer.style.transform = `translateY(${currentTranslateTop}px)`;
                }

                if (isDraggingBottom) {
                    isDraggingBottom = false;
                    bottomDrawer.style.transition = 'transform 0.3s ease';

                    if (currentTranslateBottom > bottomDrawer.offsetHeight * 0.7) {
                        currentTranslateBottom = bottomDrawer.offsetHeight - 40;
                    } else if (currentTranslateBottom > bottomDrawer.offsetHeight * 0.3) {
                        currentTranslateBottom = bottomDrawer.offsetHeight * 0.5;
                    } else {
                        currentTranslateBottom = 0;
                    }

                    bottomDrawer.style.transform = `translateY(${currentTranslateBottom}px)`;
                }
            });

            setupXylophoneEffect();

            function setupEmptyEntryInteractions() {
                const emptyEntries = document.querySelectorAll('.entry:empty, .brick:empty');
                const knockSound = document.getElementById('knock-sound');

                emptyEntries.forEach(entry => {
                    let hasPlayed = false;

                    entry.addEventListener('mouseenter', () => {
                        if (!hasPlayed) {
                            knockSound.currentTime = 0;
                            knockSound.play();
                            hasPlayed = true;

                            setTimeout(() => {
                                hasPlayed = false;
                            }, knockSound.duration * 1000 || 1000);
                        }
                    });
                });
            }
        });
    </script>
</body>

</html>