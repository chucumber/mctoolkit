<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page.title }} | MC toolkit</title>
    <link rel="stylesheet" href="assets/essay.css">
    <link rel="stylesheet" href="assets/gallery.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.3/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.3/jquery-ui.min.js"></script>
    <script src="assets/essay.js" defer></script>

    <style>
        :root {
            --gutter: 15px;
            --min-col: 40px;
            --max-col: calc(100% - 40px);
            --collapsed-width: 40px;
            --snap-threshold: 200px;
        }

        :root {
            --font-body: 'Velvelyne', sans-serif;
            --font-title: 'Compagnon', monospace;
            --line-height-body: 1.5;
            --line-height-title: 1.2;
            --line-height-small: 1.2;
            --color-bl: #4489EA;
            --color-gr: #C9FF34;
            --color-lg: #D9D9D9;
            --color-pk: #FF71E3;
            --color-br: #AF8F67;
            --color-dg: #949494;
            --color-ui: #aeaeae;
        }

        .split-container {
            display: flex;
            width: 100%;
            height: 100%;
            overflow: hidden;
            position: relative;
        }

        .pane {
            overflow: auto;
            transition: width 0.2s ease, opacity 0.2s ease;
        }

        .left {
            flex: 0 0 auto;
            position: relative;
        }

        .right {
            flex: 0 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            opacity: 1;
            pointer-events: all;
            background: var(--color-lg);
            position: relative;
        }

        .right.collapsed {
            pointer-events: none;
            justify-content: center;
        }

        .right.collapsed ul {
            display: none;
        }

        .menu-label {
            display: none;
            font-family: var(--font-title);
            writing-mode: vertical-rl;
            letter-spacing: 0.25rem;
            font-size: 1rem;
            cursor: pointer;
            user-select: none;
        }

        .right.collapsed .menu-label {
            display: block;
        }

        .divider {
            flex: 0 0 var(--gutter);
            cursor: col-resize;
            position: relative;
            z-index: 10;
            border-right: var(--color-ui) 1px solid;
            border-left: var(--color-ui) 1px solid;
        }

        .divider:hover {
            background: #f6f6f6;
        }


        .divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);

            width: 4px;
            /* width of each dot */
            height: 4px;
            /* height of each dot */
            background: var(--color-ui);
            /* dot color */
            border-radius: 50%;
            /* circular dots */

            box-shadow:
                0 10px var(--color-ui),
                0 20px var(--color-ui),
                0 30px var(--color-ui),
                0 -10px var(--color-ui),
                0 -20px var(--color-ui),
                0 -30px var(--color-ui);
        }

        ::-webkit-scrollbar {
            width: 15px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--color-pk);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #FF8CEC;
            cursor: grab;
        }

        @media (max-width: 768px) {

            html,
            body {
                height: auto;
                overflow-y: auto;
                overflow-x: hidden;
            }

            .split-container {
                flex-direction: column;
                height: auto;
                overflow-y: visible;
            }

            .divider {
                display: none;
            }

            .left,
            .right {
                width: 100vw !important;
                overflow-x: hidden;
            }

            .right {
                order: 2;
                border-top: 1px solid var(--color-ui);
                margin-top: 4rem;
            }

            .left {
                order: 1;
            }

            ::-webkit-scrollbar {
                width: 5px;
            }

        }
    </style>
</head>

<body>

    <div id="split" class="split-container">
        <div id="leftPane" class="pane left">
            {{ content }}
        </div>

        <div id="divider" class="divider" tabindex="0" role="separator" aria-orientation="vertical"
            title="drag to resize">
        </div>

        <div id="rightPane" class="pane right collapsed">
            <div class="menu-label" tabindex="0" role="button" aria-label="Expand related content">menu</div>
            <ul id="menu">
                <li id="home-link"><a href="index.html">Home</a></li>
                <li class="bg-pk" id="first-li"><a href="foreword-kristina">A Reflection on Mobilizing Citizenship</a></li>
            <li class="bg-pk"><a href="foreword-lee">Foreword, Lee Heinemann</a></li>
            <li class="bg-bl"><a href="a-space-for-agency">A Space for Agency: Walk of Shame on Cultivating
                    Collective Care in Education</a></li>
            <li class="bg-bl"><a href="hey-hey-look-at-me">Hey, Hey, Look at Me!: Lex Brown on Clowns, Citizenship, and
                    the Power of
                    Play</a>
            </li>
            <li class="bg-bl"><a href="are-you-listening">Are You Listening? Deep Listening as Youth Pedagogy</a>
            </li>
            <li class="bg-bl"><a href="self-as-archive">Self as Archive: A workshop on Erasure + World-Building</a></li>
            <li class="bg-bl"><a href="what-we-hold-sacred">What We Hold Sacred: A Workshop on Altar-Making</a>
            </li>
            <li class="bg-br"><a href="let-me-be-for-you">Let Me Be for You What I Needed When I Was Your Age</a>
            </li>
            <li class="bg-br"><a href="youth-workers">How Youth Workers Create Meaningful Encounters for Young
                    People</a></li>

            <li class="bg-gr"><a href="contributor">Contributors</a></li>
            </ul>
        </div>
    </div>

    <script>
        (() => {
            const left = document.getElementById('leftPane');
            const right = document.getElementById('rightPane');
            const divider = document.getElementById('divider');
            const menuLabel = right.querySelector('.menu-label');

            const rootStyle = getComputedStyle(document.documentElement);
            const gutter = parseFloat(rootStyle.getPropertyValue('--gutter'));
            const minCol = parseFloat(rootStyle.getPropertyValue('--min-col'));
            const collapsedWidth = parseFloat(rootStyle.getPropertyValue('--collapsed-width'));
            const snapThreshold = parseFloat(rootStyle.getPropertyValue('--snap-threshold'));

            let isDragging = false;
            let rightWidth = 240;

            let leftWidth = window.innerWidth - gutter - rightWidth;
            let rafId = null;

            applySizes();

            // Pointer events for cross-device drag
            divider.addEventListener('pointerdown', startDrag);
            menuLabel.addEventListener('click', expandMenu);
            window.addEventListener('resize', handleResize);

            function startDrag(e) {
                e.preventDefault();
                isDragging = true;
                document.body.style.cursor = 'col-resize';
                document.body.style.userSelect = 'none';

                const onMove = (e) => {
                    if (!isDragging) return;
                    if (rafId) cancelAnimationFrame(rafId);
                    rafId = requestAnimationFrame(() => {
                        const newLeft = e.clientX;
                        if (newLeft < minCol || newLeft > window.innerWidth - gutter) return;
                        leftWidth = newLeft;
                        rightWidth = window.innerWidth - leftWidth - gutter;
                        applySizes();
                    });
                };

                const stopDrag = () => {
                    isDragging = false;
                    document.body.style.cursor = '';
                    document.body.style.userSelect = '';
                    if (rightWidth < snapThreshold) collapseRight();
                    window.removeEventListener('pointermove', onMove);
                    window.removeEventListener('pointerup', stopDrag);
                };

                window.addEventListener('pointermove', onMove);
                window.addEventListener('pointerup', stopDrag);
            }

            function handleResize() {
                const total = window.innerWidth - gutter;
                leftWidth = total - rightWidth;
                applySizes();
            }

            function collapseRight() {
                rightWidth = collapsedWidth;
                leftWidth = window.innerWidth - gutter - rightWidth;
                applySizes();
            }

            function expandMenu() {
                rightWidth = 250;
                leftWidth = window.innerWidth - gutter - rightWidth;
                applySizes();
            }

            function applySizes() {
                left.style.width = `${leftWidth}px`;
                right.style.width = `${rightWidth}px`;

                // Keep "Menu" label visible until pane exceeds snap-threshold
                if (rightWidth <= snapThreshold) {
                    right.classList.add('collapsed');
                } else {
                    right.classList.remove('collapsed');
                }
            }

        })();
    </script>
</body>

</html>